var url="https://codingninjas.in/api/v3/mentors/get_ta_resolved_doubts",token="";function sortTable(t){var e,a,r,n,s,o,l,d,i=0;for(e=document.getElementById("myTable"),r=!0,d="asc";r;){for(r=!1,a=e.rows,n=1;n<a.length-1;n++)if(l=!1,s=a[n].getElementsByTagName("td")[t],o=a[n+1].getElementsByTagName("td")[t],"asc"==d){if(s.innerHTML.toLowerCase()>o.innerHTML.toLowerCase()){l=!0;break}}else if("desc"==d&&s.innerHTML.toLowerCase()<o.innerHTML.toLowerCase()){l=!0;break}l?(a[n].parentNode.insertBefore(a[n+1],a[n]),r=!0,i++):0==i&&"asc"==d&&(d="desc",r=!0)}}var generateStats=function(t){var e='<table class="table table-bordered" id="statsTable">';e+="<tr><th>Rating</th><th>Count</th></tr>";let a=0;Object.keys(t).forEach(function(r){e+='<tr class="rating-'+r+'">',e+="null"==r?"<td><b>Unrated<b></td>":"<td><b>"+r+"<b></td>",e+="<td>"+t[r]+"</td>",e+="</tr>",a+=t[r]}),e+='<tr class="total">',e+="<td><b>Total<b></td>",e+="<td><b>"+a+"</b></td>",e+="</tr>",e+="</table>",$("div#statsTable").html(e)},makeTable=function(){$.ajax({url:url,type:"GET",dataType:"json",headers:{"content-type":"application/x-www-form-urlencoded",Authorization:"Token "+token},success:function(t){if(t.data){var e=t.data.doubts,a='<table class="table table-bordered" id="myTable">';a+="<tr>",a+='<th onclick="sortTable(0)">Sno.</th>';var r=1;$.each(e[0],function(t,e){"email"!=t&&"title"!=t&&"resolved_time"!=t&&"rating_reason"!=t&&(a+='<th onclick="sortTable('+r+')">'+t+"</th>",r++)}),a+="</tr>";var n=1;stars={1:0,2:0,3:0,4:0,5:0,null:0},$.each(e,function(t,e){stars[e.rating]++,5!=e.rating&&(a+='<tr class="rating-'+e.rating+'">',a+="<td>"+n+"</td>",n++,$.each(e,function(t,r){"email"!=t&&"title"!=t&&"resolved_time"!=t&&"rating_reason"!=t&&("name"==t&&e.rating<4?a+="<td><b>"+r+"</b></td>":a+="<td>"+r+"</td>")}),a+="</tr>")}),a+="</table>",$("div#displayTable").html(a),generateStats(stars)}else{var s='<h2 id="expiredToken">'+t.error.message+"</h2>";$("div#displayTable").html(s)}}})};$(document).ready(makeTable),$(document).ready(function(){$("form").submit(t=>{t.preventDefault(),token=t.target[0].value,makeTable()})});
